<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Panel Application</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>

<link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0/dist/css/loading.css" type="text/css" />
<style type="text/css">

:host(.pn-loading):before, .pn-loading:before {
  background-color: #c3c3c3;
  mask-size: auto calc(min(50%, 400px));
  -webkit-mask-size: auto calc(min(50%, 400px));
}
.py-error { display: none; }</style><script type="esms-options">{"shimMode": true}</script>

<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.5.2.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.5.2.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.5.2.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.5.2.min.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0/dist/panel.min.js"></script>

<script type="text/javascript">
  Bokeh.set_log_level("info");
</script>  </head>
  <body class="pn-loading pn-arc">
    <div id="b8f1ca34-e6bd-4a39-81de-c0fc1e91f7a8" data-root-id="p1002" style="display: contents;"></div>
  <div id="e9225f5d-6ff1-4bc9-98de-07e119b7e044" data-root-id="p1027" style="display: contents;"></div>
  <div id="b1c96079-6af8-4dd5-b163-d6a1da9069bd" data-root-id="p1028" style="display: contents;"></div>
  
    <script type="text/javascript">
      const pyodideWorker = new Worker("./run_force_graph_panel.js");
      pyodideWorker.busy = false
      pyodideWorker.queue = []
      
      let patching = 0
      
      function send_change(jsdoc, event) {
        if ((event.setter_id != null && event.setter_id == 'py') || (patching > 0)) {
          return
        } else if (pyodideWorker.busy && event.model && event.attr) {
          let events = []
          for (const old_event of pyodideWorker.queue) {
            if (!(old_event.model === event.model && old_event.attr === event.attr)) {
              events.push(old_event)
            }
          }
          events.push(event)
          pyodideWorker.queue = events
          return
        }
        const patch = jsdoc.create_json_patch([event])
        pyodideWorker.busy = true
        pyodideWorker.postMessage({type: 'patch', patch: patch})
      }
      
      pyodideWorker.onmessage = async (event) => {
        const msg = event.data
      
        const body = document.getElementsByTagName('body')[0]
        const loading_msgs = document.getElementsByClassName('pn-loading-msg')
        if (msg.type === 'idle') {
          if (pyodideWorker.queue.length) {
            const patch = pyodideWorker.jsdoc.create_json_patch(pyodideWorker.queue)
            pyodideWorker.busy = true
            pyodideWorker.queue = []
            pyodideWorker.postMessage({type: 'patch', patch: patch})
          } else {
            pyodideWorker.busy = false
          }
        } else if (msg.type === 'status') {
          let loading_msg
          if (loading_msgs.length) {
            loading_msg = loading_msgs[0]
          } else if (body.classList.contains('pn-loading')) {
            loading_msg = document.createElement('div')
            loading_msg.classList.add('pn-loading-msg')
            body.appendChild(loading_msg)
          }
          if (loading_msg != null) {
            loading_msg.innerHTML = msg.msg
          }
        } else if (msg.type === 'render') {
          const docs_json = JSON.parse(msg.docs_json)
          const render_items = JSON.parse(msg.render_items)
          const root_ids = JSON.parse(msg.root_ids)
      
          // Remap roots in message to element IDs
          const root_els = document.querySelectorAll('[data-root-id]')
          const data_roots = []
          for (const el of root_els) {
             el.innerHTML = ''
             data_roots.push([el.getAttribute('data-root-id'), el.id])
          }
          data_roots.sort((a, b) => a[0]<b[0] ? -1: 1)
          const roots = {}
          for (let i=0; i<data_roots.length; i++) {
            roots[root_ids[i]] = data_roots[i][1]
          }
          render_items[0]['roots'] = roots
          render_items[0]['root_ids'] = root_ids
      
          // Clear pre-rendered contents
          Bokeh.index.roots.map((v) => v.remove())
      
          // Embed content
          const [views] = await Bokeh.embed.embed_items(docs_json, render_items)
      
          // Remove loading spinner and message
          body.classList.remove("pn-loading", "arc")
          for (const loading_msg of loading_msgs) {
            loading_msg.remove()
          }
      
          // Setup bi-directional syncing
          pyodideWorker.jsdoc = jsdoc = [...views.roots.values()][0].model.document
          jsdoc.on_change(send_change.bind(null, jsdoc), false)
          pyodideWorker.postMessage({'type': 'rendered'})
          pyodideWorker.postMessage({'type': 'location', location: JSON.stringify(window.location)})
        } else if (msg.type === 'patch') {
          try {
            patching += 1
            pyodideWorker.jsdoc.apply_json_patch(msg.patch, msg.buffers)
          } finally {
            patching -= 1
          }
        }
      };
    </script>
    <script type="application/json" id="p1029">
      {"ee3e5855-6423-4178-a53c-c42e1cd782f1":{"version":"3.5.2","title":"Panel Application","roots":[{"type":"object","name":"panel.models.layout.Column","id":"p1002","attributes":{"name":"Column00136","stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"type":"object","name":"ImportedStyleSheet","id":"p1005","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/loading.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1021","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/listpanel.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1003","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/bundled/theme/default.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1004","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/bundled/theme/native.css"}}],"margin":0,"align":"start","children":[{"type":"object","name":"panel.models.widgets.Button","id":"p1007","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1006","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/button.css"}},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Set initial state"}},{"type":"object","name":"panel.models.layout.Column","id":"p1008","attributes":{"name":"WidgetBox00134","css_classes":["panel-widget-box"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1026","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/widgetbox.css"}},{"id":"p1021"},{"id":"p1003"},{"id":"p1004"}],"margin":0,"align":"start","children":[{"type":"object","name":"Row","id":"p1009","attributes":{"name":"Row00133","stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1021"},{"id":"p1003"},{"id":"p1004"}],"margin":0,"align":"start","children":[{"type":"object","name":"panel.models.esm.ReactiveESM","id":"p1011","attributes":{"name":"newClass","subscribed_events":{"type":"set","entries":["dom_event","data_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},"\n        .text-label {\n            fill: black;\n        }\n        ",{"id":"p1003"},{"id":"p1004"}],"margin":0,"align":"start","class_name":"new-class","data":{"type":"object","name":"newClass1","id":"p1010","attributes":{"name":"newClass00123"}},"esm":"\n\nexport function render({ model }) {\n    console.log(model);\n\n    let div = document.createElement(\"div\");\n    // Declare the chart dimensions and margins.\n    let nodes = []\n    let links = []\n\n    let graph = new ForceGraph(model, {nodes, links}, {\n        nodeId: d =&gt; d.id,\n        nodeGroup: d =&gt; d.group,\n        }\n    )\n    console.log(1)\n\n    div.appendChild(graph.getSVG());\n    // console.log(model)\n\n    let messageHandler = new ForceGraphMessageHandler(model, graph);\n    console.log(messageHandler)\n\n    return div;\n  }\n\nimport * as d3 from \"https://cdn.jsdelivr.net/npm/d3@7/+esm\";\n\n\n\n\n// Main ForceGraph class\nexport class ForceGraph {\n    constructor(model, data = { nodes: [], links: [] }, options = {}) {\n        let optionsObj = new ForceGraphOptions(options);\n\n        // update specified options with new values\n        // iterate through key value pairs in options\n        for (const [key, value] of Object.entries(options)) {\n            // if the key is in the options object\n            if (key in optionsObj) {\n                // set the value of the key to the new value\n                optionsObj[key] = value;\n            }\n        }\n        this.state = new SimulationState(this, model, data.nodes, data.links, optionsObj);\n        this.elementUpdater = new ElementUpdater(this, this.state);\n        this.messageHandler = new MessageHandler(this, model);\n        this.state.setElementUpdater(this.elementUpdater);\n\n        this.nodeHandler = new NodeHandler(this, this.state, this.elementUpdater);\n        this.linkHandler = new LinkHandler(this, this.state, this.elementUpdater);\n        this.highlightHandler = new HighlightHandler(this, this.state);\n\n        this.colorLegendHandler = new ColorLegendHandler(this, this.state);\n\n        this.initGraph();\n    }\n\n    initGraph() {\n        this.state.initState();\n        this.elementUpdater.updateAll();\n        this.messageHandler.sendSetupMessage(this.getNodes(), this.getLinks());\n\n    }\n\n    addNode(node) {\n        this.nodeHandler.addNode(node);\n    }\n\n    removeNode(nodeId) {\n        this.nodeHandler.removeNode(nodeId);\n    }\n\n    addLink(link) {\n        this.linkHandler.addLink(link);\n    }\n\n    removeLink(from, to) {\n        this.linkHandler.removeLink(from, to);\n    }\n\n    setHighlightedNode(nodeId, type) {\n        this.highlightHandler.setHighlightedNode(nodeId, type);\n    }\n\n    setColorScale(attribute) {\n        this.nodeHandler.setNodeColorByAttribute(attribute);\n        this.colorLegendHandler.renderLegend();\n    }\n\n    setLinkWeightAttribute(attribute) {\n        this.linkHandler.setLinkWeightAttribute(attribute);\n    }\n\n    setNodeData(nodeId, data) {\n        this.nodeHandler.setNodeData(nodeId, data);\n    }\n\n    getNodes() {\n        return this.state.nodes;\n    }\n\n    getLinks() {\n        return this.state.links;\n    }\n\n    getSVG() {\n        return this.state.svg.node();\n    }\n}\n\n// SimulationState class to manage and pass around graph state\nclass SimulationState {\n    constructor(parent, model, nodesData, linksData, options) {\n        this.parent = parent;\n        this.model = model;\n        this.nodesData = nodesData;\n        this.linksData = linksData;\n        this.nodes = [];\n        this.links = [];\n        this.simulation = null;\n        this.highlightCircles = {};\n        this.options = options;\n\n        this.nodeColorAttribute = null;\n        this.linkWeightAttribute = null;\n        // this.initState();\n    }\n\n    setElementUpdater(elementUpdater) {\n        this.elementUpdater = elementUpdater;\n    }\n\n    // Method to reset the simulation parameters\n    resetSimulation(alpha = 1) {\n        if ((alpha &gt; 1) || (alpha &lt; 0)) {\n            console.warn(`Invalid alpha value: ${alpha}`);\n            return;\n        }\n\n        this.simulation.alpha(alpha).restart();\n    }\n\n    // Method to dynamically adjust simulation forces\n    configureForces(nodeStrength, linkStrength) {\n        this.simulation.force(\"charge\", d3.forceManyBody().strength(nodeStrength));\n        this.simulation.force(\"link\", d3.forceLink(this.links).strength(linkStrength).id(d =&gt; d.id));\n    }\n\n    intern(value) {\n        return value !== null &amp;&amp; typeof value === \"object\" ? value.valueOf() : value;\n    }\n\n    initState() {\n        this.simulation = d3.forceSimulation(this.nodes)\n            .force(\"link\", d3.forceLink(this.links).id(d =&gt; d.id))\n            .force(\"charge\", d3.forceManyBody())\n            .force(\"center\", d3.forceCenter())\n            .on(\"tick\", () =&gt; this.elementUpdater.ticked());\n\n        const options = this.options;\n        this.svg = d3.create(\"svg\")\n            .attr(\"width\", options.width)\n            .attr(\"height\", options.height)\n            .attr(\"viewBox\", [-options.width / 2, -options.height / 2, options.width, options.height])\n            .attr(\"style\", \"max-width: 100%; height: auto; height: intrinsic;\")\n            .call(this.zoom());\n\n        this.g = this.svg.append(\"g\");\n\n        this.linkGroup = this.g.append(\"g\")\n            .attr(\"stroke\", options.linkStroke)\n            .attr(\"stroke-opacity\", options.linkStrokeOpacity)\n            .attr(\"stroke-width\", options.linkStrokeWidth)\n            .attr(\"stroke-linecap\", options.linkStrokeLinecap);\n\n        this.nodeGroup = this.g.append(\"g\")\n            .attr(\"fill\", options.nodeFill)\n            .attr(\"stroke\", options.nodeStroke)\n            .attr(\"stroke-opacity\", options.nodeStrokeOpacity)\n            .attr(\"stroke-width\", options.nodeStrokeWidth);\n    }\n\n    zoom() {\n        return d3.zoom()\n            .scaleExtent([0.1, 10])\n            .on(\"zoom\", (event) =&gt; {\n                this.g.attr(\"transform\", event.transform);\n            });\n    }\n}\n\n\n// ElementUpdater class to handle centralized updates\nclass ElementUpdater {\n    constructor(parent, state) {\n        this.parent = parent;\n        this.state = state;\n    }\n\n\n\n    updateAll() {\n        this.updateLinks();\n        this.updateNodes();\n        this.updateHighlights();\n    }\n\n    ticked() {\n        this.state.linkElements\n            .attr(\"x1\", d =&gt; d.source.x)\n            .attr(\"y1\", d =&gt; d.source.y)\n            .attr(\"x2\", d =&gt; d.target.x)\n            .attr(\"y2\", d =&gt; d.target.y);\n\n        this.state.nodeElements\n            .attr(\"cx\", d =&gt; d.x)\n            .attr(\"cy\", d =&gt; d.y);\n\n        this.updateHighlights();\n\n        // Update position of node labels to follow nodes\n        this.state.nodeLabels\n            .attr(\"x\", d =&gt; d.x)\n            .attr(\"y\", d =&gt; d.y + this.state.options.nodeRadius + 10);\n    }\n\n\n\n    updateNodes() {\n        const nodeGroup = this.state.nodeGroup;\n        const nodes = this.state.nodes;\n        const options = this.state.options;\n\n        const colorAttribute = this.state.nodeColorAttribute;\n        const colorScale = this.state.nodeColorScale;\n\n        const maxAttrValue = d3.max(nodes, d =&gt; d.data[colorAttribute]);\n        const minAttrValue = d3.min(nodes, d =&gt; d.data[colorAttribute]);\n\n        function normAttrValue(value) {\n            if (maxAttrValue === minAttrValue) {\n                return 0;\n            }\n\n            return ((value - minAttrValue) / (maxAttrValue - minAttrValue)) * 100;\n        }\n\n        function getColor(d) {\n            if (colorAttribute &amp;&amp; colorScale) {\n                const attrVal = d.data[colorAttribute];\n                const normedAttrValue = normAttrValue(attrVal);\n                const colorVal = colorScale(normedAttrValue);\n                return colorVal;\n            }\n            return options.nodeFill;\n        }\n\n        this.state.nodeElements = nodeGroup.selectAll(\"circle\")\n            .data(nodes, d =&gt; d.id)\n            .join(\"circle\")\n            .attr(\"r\", options.nodeRadius)\n            .attr(\"fill\", getColor)\n            // add node id as text\n            .call(this.drag(this.state.simulation));\n\n        this.state.nodeLabels = nodeGroup.selectAll(\"text\")\n            .data(nodes, d =&gt; d.id)\n            .join(\"text\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"dy\", options.nodeRadius + 10)  // Position below the node\n            .attr(\"fill\", \"black\")  // Set font color to black\n            .attr(\"stroke-width\", 0)  // Set font stroke width\n            .text(d =&gt; d.id);\n    }\n\n    updateLinks() {\n        const linkGroup = this.state.linkGroup;\n        const links = this.state.links;\n        const options = this.state.options;\n\n        const weightAttribute = this.state.linkWeightAttribute;\n\n        const maxWeight = d3.max(links, d =&gt; d.data[weightAttribute]);\n        const minWeight = d3.min(links, d =&gt; d.data[weightAttribute]);\n\n        function normWeight(value) {\n            if (maxWeight === minWeight) {\n                return 100;\n            }\n            return ((value - minWeight) / (maxWeight - minWeight)) * 75 + 25;\n        }\n\n        function getWeight(d) {\n            return weightAttribute ? normWeight(d.data[weightAttribute]) : 100 || 100;\n        }\n\n        this.state.linkElements = linkGroup.selectAll(\"line\")\n            .data(links)\n            .join(\"line\")\n            .attr(\"stroke-width\", d =&gt; options.linkStrokeWidth * getWeight(d) / 100)\n            .attr(\"stroke\", options.linkStroke)\n            .call(this.drag(this.state.simulation));\n    }\n\n    updateHighlights() {\n        if (!this.state.highlightCircles) {\n            console.warn(\"No highlight circles found. skipping update.\");\n            return;\n        }\n\n        Object.keys(this.state.highlightCircles).forEach(type =&gt; {\n            const node = this.state[`highlightedNode_${type}`];\n            if (node) {\n                this.state.highlightCircles[type]\n                    .attr(\"cx\", node.x)\n                    .attr(\"cy\", node.y);\n            }\n        });\n    }\n\n\n    drag(simulation) {\n        let messageHandler = this.parent.messageHandler;\n        function dragstarted(event, d) {\n            if (!event.active) simulation.alphaTarget(0.3).restart();\n            let messageData = {}\n            if (d.source) {\n                messageData = { source: d.source.id, target: d.target.id, isSecondary: event.sourceEvent.shiftKey, data: d.data }\n            } else {\n                console.log(event.sourceEvent)\n                messageData = { id: d.id, isSecondary: (event.sourceEvent.altKey || event.sourceEvent.ctrlKey || event.sourceEvent.metaKey), data: d.data }\n            }\n            messageHandler.sendMessage('DragStarted', messageData)\n            d.fx = d.x;\n            d.fy = d.y;\n        }\n\n        function dragged(event, d) {\n            d.fx = event.x;\n            d.fy = event.y;\n        }\n\n        function dragended(event, d) {\n            if (!event.active) simulation.alphaTarget(0);\n            // model.send_msg(`type:dragended, id:${d.id}`, 'dragended')\n            //   parent.sendMessage('dragEnded', {id: d.id})\n            d.fx = null;\n            d.fy = null;\n        }\n\n        return d3.drag()\n            .on(\"start\", dragstarted)\n            .on(\"drag\", dragged)\n            .on(\"end\", dragended);\n    }\n\n}\n\n\n// NodeHandler class\nclass NodeHandler {\n    constructor(parent, state, elementUpdater) {\n        this.parent = parent;\n        this.state = state;\n        this.elementUpdater = elementUpdater;\n        this.initNodes();\n    }\n\n    initNodes() {\n        //   const { nodesData, options } = this.state;\n        const nodesData = this.state.nodesData;\n        const options = this.state.options;\n\n        const N = d3.map(nodesData, options.nodeId).map(this.state.intern);\n        this.state.nodes = d3.map(nodesData, (data, i) =&gt; ({ id: N[i], data }));\n    }\n\n    addNode(node) {\n        if (this.state.nodes.find(n =&gt; n.id === node.id)) {\n            console.warn(`Node with ID ${node.id} already exists.`);\n            this.parent.messageHandler.sendMessage(\"Error\", { message: `Node with ID ${node.id} already exists.` });\n            return;\n        }\n\n        this.state.nodes.push(node);\n        this.state.simulation.nodes(this.state.nodes);\n        this.elementUpdater.updateAll();\n        this.state.resetSimulation();\n        this.parent.messageHandler.sendMessage(\"AddNode\", { id: node.id, group: node.group });\n        this.parent.colorLegendHandler.renderLegend();\n    }\n\n    removeNode(nodeId) {\n        this.state.nodes = this.state.nodes.filter(node =&gt; node.id !== nodeId);\n        this.state.links = this.state.links.filter(link =&gt; link.source !== nodeId &amp;&amp; link.target !== nodeId);\n        this.state.simulation.nodes(this.state.nodes);\n        this.state.simulation.force(\"link\", d3.forceLink(this.state.links).id(d =&gt; d.id));\n        this.elementUpdater.updateAll();\n        this.state.resetSimulation();\n        this.parent.messageHandler.sendMessage(\"RemoveNode\", { id: nodeId });\n\n        this.parent.linkHandler.getConnections(nodeId).forEach(link =&gt; {\n            this.parent.linkHandler.removeLink(link.source.id, link.target.id);\n        }\n        );\n\n        this.parent.highlightHandler.setHighlightedNode(null, \"selectionOne\");\n\n    }\n\n    setNodeColorByAttribute(attribute) {\n        this.state.nodeColorAttribute = attribute;\n        this.state.nodeColorScale = d3.scaleLinear([0, 100], this.state.options.colorScale);\n        this.elementUpdater.updateNodes();\n    }\n\n    setNodeData(nodeId, data) {\n        const node = this.state.nodes.find(n =&gt; n.id === nodeId);\n        if (!node) {\n            console.warn(`Node with ID ${nodeId} not found.`);\n            this.parent.messageHandler.sendMessage(\"Error\", { message: `Node with ID ${nodeId} not found.` });\n            return;\n        }\n        console.log(data)\n        node.data = data;\n        console.log(node)\n        this.elementUpdater.updateNodes();\n\n        const updatedNode = this.state.nodes.find(n =&gt; n.id === nodeId);\n        const updatedNodeElement = this.state.nodeGroup.selectAll(\"circle\").filter(d =&gt; d.id === nodeId);\n\n        console.log(updatedNodeElement)\n        console.log(updatedNode)\n\n        this.parent.messageHandler.sendMessage('DragStarted', {\n            id: nodeId,\n            isSecondary: false,\n            data: data,\n        })\n        this.parent.colorLegendHandler.renderLegend();\n    }\n\n}\n\n// LinkHandler class\nclass LinkHandler {\n    constructor(parent, state, elementUpdater) {\n        this.parent = parent;\n        this.state = state;\n        this.elementUpdater = elementUpdater;\n        this.initLinks();\n    }\n\n    initLinks() {\n        //   const { linksData, options } = this.state;\n        const options = this.state.options;\n        const linksData = this.state.linksData;\n\n        const LS = d3.map(linksData, options.linkSource).map(this.state.intern);\n        const LT = d3.map(linksData, options.linkTarget).map(this.state.intern);\n        this.state.links = d3.map(linksData, (data, i) =&gt; ({ source: LS[i], target: LT[i], data }));\n    }\n\n    getLink(from, to) {\n        return this.state.links.find(link =&gt; (link.source.id === from) &amp;&amp; (link.target.id === to));\n    }\n\n    directionlessGetLink(from, to) {\n        return this.getLink(from, to) || this.getLink(to, from);\n    }\n\n    getConnections(nodeId) {\n        return this.state.links.filter(link =&gt; (link.source.id === nodeId) || (link.target.id === nodeId));\n    }\n\n    addLink(link) {\n\n        let existingLink = this.directionlessGetLink(link.source, link.target);\n        if (existingLink) {\n            console.warn(`Link from ${link.source} to ${link.target} already exists.`);\n            this.parent.messageHandler.sendMessage(\"error\", { message: `Link from ${link.source} to ${link.target} already exists.` });\n            return;\n        }\n\n        link.source = this.state.options.linkSource(link);\n        link.target = this.state.options.linkTarget(link);\n        if (!this.state.nodes.find(node =&gt; node.id === link.source) || !this.state.nodes.find(node =&gt; node.id === link.target)) {\n            console.warn(`Error: Missing source or target node for link ${link}`);\n            this.parent.messageHandler.sendMessage(\"error\", { message: `Missing source or target node for link ${link}` });\n            return;\n        }\n        this.state.links.push(link);\n        this.state.simulation.force(\"link\", d3.forceLink(this.state.links).id(d =&gt; d.id));\n        this.state.resetSimulation();\n        this.elementUpdater.updateAll();\n    }\n\n    removeLink(from, to) {\n        const matchingLink = this.directionlessGetLink(from, to);\n        if (matchingLink) {\n            this.state.links = this.state.links.filter(link =&gt; link !== matchingLink);\n            this.state.simulation.force(\"link\", d3.forceLink(this.state.links).id(d =&gt; d.id));\n            this.state.resetSimulation();\n            this.elementUpdater.updateAll();\n        } else {\n            console.warn(`No link found from ${from} to ${to}`);\n        }\n    }\n\n    setLinkWeightAttribute(attribute) {\n        this.state.linkWeightAttribute = attribute;\n        this.elementUpdater.updateLinks();\n    }\n}\n\n\nclass MessageHandler {\n    constructor(parent, model) {\n        this.parent = parent;\n        this.model = model;\n        this.debug = false;\n    }\n\n    sendMessage(messageType, data) {\n        if (this.debug) {\n            console.log(`Sending message: ${messageType}, data: ${JSON.stringify(data)}`);\n        }\n        let messagePackage = {\n            type: messageType,\n            data: data,\n        };\n        let jsonPackage = JSON.stringify(messagePackage);\n        this.model.send_msg(jsonPackage, \"\");\n    }\n\n    sendSetupMessage(nodes, links) {\n        let messagePackage = { nodes, links };\n        this.sendMessage(\"setup\", messagePackage);\n    }\n}\n\n// HighlightHandler class for node highlighting functionality\nclass HighlightHandler {\n    constructor(parent, state) {\n        this.parent = parent;\n        this.state = state;\n    }\n\n    setHighlightedNode(nodeId, type) {\n        if (nodeId == null) {\n            this.state.highlightCircles[type].remove();\n            return;\n        }\n\n        // Define colors for each type\n        const highlightColors = {\n            selectionOne: \"red\",\n            selectionTwo: \"blue\",\n            selectionThree: \"green\",\n        };\n\n        const highlightAlphas = {\n            selectionOne: 0.8,\n            selectionTwo: 0.4,\n            selectionThree: 0.2,\n        };\n\n        // Validate type\n        if (!highlightColors[type]) {\n            console.warn(`Invalid highlight type: ${type}`);\n            return;\n        }\n\n        // Remove any existing highlight of the same type\n        if (this.state.highlightCircles[type]) {\n            this.state.highlightCircles[type].remove();\n        }\n\n        // Find the node element by ID\n        const node = this.state.nodes.find(d =&gt; d.id === nodeId);\n\n        if (!node) {\n            console.warn(`Node with ID ${nodeId} not found.`);\n            return;\n        }\n\n        // Create a circle around the specified node for highlighting of the given type\n        const highlightCircle = this.state.g.append(\"circle\")\n            .attr(\"class\", `highlight-circle ${type}`)\n            .attr(\"r\", this.state.options.nodeRadius * 1.5)  // Set radius slightly larger than the node\n            .attr(\"fill\", \"none\")\n            .attr(\"stroke\", highlightColors[type])\n            .attr(\"stroke-width\", 2)\n            .attr(\"stroke-opacity\", highlightAlphas[type]);\n\n        // Initial position update for the highlight circle\n        highlightCircle\n            .attr(\"cx\", node.x)\n            .attr(\"cy\", node.y);\n\n        // Store the circle and node reference for this type\n        this.state.highlightCircles[type] = highlightCircle;\n        this.state[`highlightedNode_${type}`] = node;\n\n    }\n}\n\n\n// ColorLegendHandler class to render color legend based on node color attribute\nclass ColorLegendHandler {\n    constructor(parent, state) {\n        this.parent = parent;\n        this.state = state;\n        this.colorLegend = null;\n        this.renderLegend();\n    }\n\n    renderLegend() {\n        // Remove existing legend if any\n        if (this.colorLegend) {\n            this.colorLegend.remove();\n        }\n\n        const { nodeColorAttribute, nodeColorScale, nodes } = this.state;\n        if (!nodeColorAttribute || !nodeColorScale || nodes.length === 0) return;\n\n        // Get min and max values of the color attribute\n        const minAttrValue = d3.min(nodes, d =&gt; d.data[nodeColorAttribute]);\n        const maxAttrValue = d3.max(nodes, d =&gt; d.data[nodeColorAttribute]);\n\n        const width = this.state.options.width;\n        const height = this.state.options.height;\n\n        // Create a color scale legend group\n        this.colorLegend = this.state.svg.append(\"g\")\n            .attr(\"class\", \"color-legend\")\n            .attr(\"transform\", `translate(${width * 0.4}, ${height * - 0.3})`);\n        //right align and vertically center\n\n\n        // Define a linear gradient for the color scale\n        const gradient = this.colorLegend.append(\"defs\")\n            .append(\"linearGradient\")\n            .attr(\"id\", \"colorGradient\")\n            .attr(\"x1\", \"0%\")\n            .attr(\"y1\", \"0%\")\n            .attr(\"x2\", \"0%\")\n            .attr(\"y2\", \"100%\");\n\n        gradient.append(\"stop\")\n            .attr(\"offset\", \"0%\")\n            .attr(\"stop-color\", nodeColorScale(100));  // Top of gradient (max color)\n\n        gradient.append(\"stop\")\n            .attr(\"offset\", \"100%\")\n            .attr(\"stop-color\", nodeColorScale(0));  // Bottom of gradient (min color)\n\n        // Draw a rectangle using the gradient\n        this.colorLegend.append(\"rect\")\n            .attr(\"x\", 0)\n            .attr(\"y\", 0)\n            .attr(\"width\", 20)\n            .attr(\"height\", 100)\n            .style(\"fill\", \"url(#colorGradient)\");\n\n        // Add min and max labels\n        this.colorLegend.append(\"text\")\n            .attr(\"x\", 25)\n            .attr(\"y\", 5)\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"dominant-baseline\", \"hanging\")\n            .text(maxAttrValue.toFixed(2));\n\n        this.colorLegend.append(\"text\")\n            .attr(\"x\", 25)\n            .attr(\"y\", 95)\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"dominant-baseline\", \"baseline\")\n            .text(minAttrValue.toFixed(2));\n\n        // add a legend title (the attribute name)\n        this.colorLegend.append(\"text\")\n            .attr(\"x\", 0)\n            .attr(\"y\", -20)\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"dominant-baseline\", \"hanging\")\n            .text(nodeColorAttribute);\n\n        console.log(this.colorLegend)\n    }\n}\n\n\n// ForceGraphOptions class remains the same\nexport class ForceGraphOptions {\n    constructor({\n        nodeId = d =&gt; d.id,\n        nodeGroup,\n        nodeGroups,\n        nodeTitle = d =&gt; d.id,\n        nodeFill = \"5555\",\n        nodeStroke = \"#fff\",\n        nodeStrokeWidth = 2.5,\n        nodeStrokeOpacity = 1,\n        nodeRadius = 5,\n        nodeStrength,\n        linkSource = ({ source }) =&gt; source,\n        linkTarget = ({ target }) =&gt; target,\n        linkStroke = \"#999\",\n        linkStrokeOpacity = 0.6,\n        linkStrokeWidth = 3,//l =&gt; (l.data || {}).value || 3,\n        linkStrokeLinecap = \"round\",\n        linkStrength,\n        width = 640,\n        height = 400,\n        colorScale = [\"blue\", \"orange\"],\n        invalidation\n    } = {}) {\n\n\n        this.nodeId = nodeId;\n        this.nodeGroup = nodeGroup;\n        this.nodeGroups = nodeGroups;\n        this.nodeTitle = nodeTitle;\n        this.nodeFill = nodeFill;\n        this.nodeStroke = nodeStroke;\n        this.nodeStrokeWidth = nodeStrokeWidth;\n        this.nodeStrokeOpacity = nodeStrokeOpacity;\n        this.nodeRadius = nodeRadius;\n        this.nodeStrength = nodeStrength;\n        this.linkSource = linkSource;\n        this.linkTarget = linkTarget;\n        this.linkStroke = linkStroke;\n        this.linkStrokeOpacity = linkStrokeOpacity;\n        this.linkStrokeWidth = linkStrokeWidth;\n        this.linkStrokeLinecap = linkStrokeLinecap;\n        this.linkStrength = linkStrength;\n        this.colorScale = colorScale;\n        this.width = width;\n        this.height = height;\n        this.invalidation = invalidation;\n\n    }\n\n\n}\n\nexport class ForceGraphMessageHandler {\n    constructor(model, graph) {\n        this.model = model;\n        this.graph = graph;\n        this.setCallbacks();\n        this.debug = false;\n    }\n\n    setCallbacks() {\n        this.model.on('msg:custom', (msg) =&gt; {\n            this.handleCallbackGeneric(msg);\n        });\n    }\n\n    handleCallbackGeneric(msg) {\n        // create dict string of msg\n        if (this.debug) {\n            console.log(`Handling Callback: ${JSON.stringify(msg)}`);\n        }\n\n        let endpoint = msg.endpoint;\n        let data = msg.data;\n\n        if (this.debug) {\n            console.log(`Endpoint: ${endpoint}`);\n            console.log(`Data: ${JSON.stringify(data)}`);\n        }\n\n        //add a switch statement to handle different callback types\n        switch (endpoint) {\n            case \"AddNode\":\n                this.handleAddNode(data);\n                break;\n            case \"SelectHighlight\":\n                this.handleSelectHighlight(data);\n                break;\n            case \"ConnectNodes\":\n                this.handleConnectNodes(data);\n                break;\n            case \"RemoveNode\":\n                this.handleRemoveNode(data);\n                break;\n            case \"RemoveLink\":\n                this.handleRemoveLink(data);\n                break;\n            case \"SetColorScale\":\n                this.handleSetColorScale(data);\n                break;\n            case \"SetLinkWeightAttribute\":\n                this.handleSetLinkWeightAttribute(data);\n                break;\n            case \"SetNodeData\":\n                this.handleSetNodeData(data);\n                break;\n            default:\n                console.error(`Unknown endpoint: ${endpoint}`);\n        }\n    }\n\n    handleAddNode(data) {\n\n        let nodeId = data.id;\n        let _data = data.data;\n        let nodeGroup = _data.group;\n        let nodeLinkTo = data.linkTo;\n        let nodeLinkData = data.linkData;\n\n        this.graph.addNode({ id: nodeId, group: nodeGroup, data: _data });\n\n        if (nodeLinkTo) {\n            if (this.debug) {\n                console.log(`Adding link from ${nodeId} to ${nodeLinkTo}`);\n            }\n            this.graph.addLink({ source: nodeId, target: nodeLinkTo, data: nodeLinkData });\n        }\n    }\n\n    handleSelectHighlight(data) {\n        if (this.debug) {\n            console.log(`Handling Select Highlight: ${data.id}, highlightType: ${data.highlightType}`);\n        }\n        this.graph.setHighlightedNode(data.id, data.highlightType);\n    }\n\n    handleConnectNodes(data) {\n        if (this.debug) {\n            console.log(`Handling Connect Nodes: ${data.source} ${data.target}`);\n        }\n        this.graph.addLink({ source: data.source, target: data.target, data: data.data });\n    }\n\n    handleRemoveNode(data) {\n        if (this.debug) {\n            console.log(`Handling Remove Node: ${data.id}`);\n        }\n        this.graph.removeNode(data.id);\n    }\n\n    handleRemoveLink(data) {\n        if (this.debug) {\n            console.log(`Handling Remove Link: ${data.source} ${data.target}`);\n        }\n        this.graph.removeLink(data.source, data.target);\n    }\n\n    handleSetColorScale(data) {\n        if (this.debug) {\n            console.log(`Handling Set Color Scale: ${data}`);\n        }\n        this.graph.setColorScale(data.attribute);\n    }\n\n    handleSetLinkWeightAttribute(data) {\n        if (this.debug) {\n            console.log(`Handling Set Link Weight Attribute: ${data.attribute}`);\n        }\n        this.graph.setLinkWeightAttribute(data.attribute);\n    }\n    handleSetNodeData(data) {\n        if (this.debug) {\n            console.log(`Handling Set Node Data: ${data.id} ${JSON.stringify(data.data)}`);\n        }\n        this.graph.setNodeData(data.id, data.data);\n    }\n}"}},{"type":"object","name":"panel.models.layout.Column","id":"p1012","attributes":{"name":"Column00132","stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1021"},{"id":"p1003"},{"id":"p1004"}],"margin":0,"align":"start","children":[{"type":"object","name":"panel.models.widgets.Button","id":"p1013","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1006"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Connect nodes"}},{"type":"object","name":"panel.models.widgets.TextInput","id":"p1014","attributes":{"subscribed_events":{"type":"set","entries":["enter-pressed"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1003"},{"id":"p1004"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"New ID","value":"0","max_length":5000}},{"type":"object","name":"panel.models.widgets.Button","id":"p1015","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1006"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Add node"}},{"type":"object","name":"panel.models.widgets.Button","id":"p1016","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1006"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Remove node"}},{"type":"object","name":"panel.models.widgets.Button","id":"p1017","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1006"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Remove link"}},{"type":"object","name":"panel.models.widgets.CustomSelect","id":"p1019","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1018","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/select.css"}},{"id":"p1003"},{"id":"p1004"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Color scale attribute","options":["size","age","name"],"value":"size"}},{"type":"object","name":"panel.models.widgets.CustomSelect","id":"p1020","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1018"},{"id":"p1003"},{"id":"p1004"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Link weight attribute","options":["weight","strength"],"value":"weight"}}]}}]}},{"type":"object","name":"panel.models.markup.HTML","id":"p1023","attributes":{"css_classes":["markdown"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1022","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0/dist/css/markdown.css"}},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","text":"&amp;lt;p&amp;gt;Selected node:&amp;lt;/p&amp;gt;\n"}},{"type":"object","name":"panel.models.markup.HTML","id":"p1024","attributes":{"css_classes":["markdown"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1022"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","text":"&amp;lt;p&amp;gt;No errors&amp;lt;/p&amp;gt;\n"}},{"type":"object","name":"panel.models.widgets.Button","id":"p1025","attributes":{"subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1005"},{"id":"p1006"},{"id":"p1003"},{"id":"p1004"}],"margin":[5,10],"align":"start","label":"Shuffle node parameters"}}]}}]}},{"type":"object","name":"panel.models.location.Location","id":"p1027","attributes":{"name":"location","reload":false}},{"type":"object","name":"panel.models.browser.BrowserInfo","id":"p1028","attributes":{"name":"browser_info"}}],"defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"gap","kind":"Any","default":""},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"TemplateEditor1","properties":[{"name":"layout","kind":"Any","default":[]}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"ReactiveESM1"},{"type":"model","name":"JSComponent1"},{"type":"model","name":"ReactComponent1"},{"type":"model","name":"AnyWidgetComponent1"},{"type":"model","name":"request_value1","properties":[{"name":"fill","kind":"Any","default":"none"},{"name":"_synced","kind":"Any","default":null},{"name":"_request_sync","kind":"Any","default":0}]},{"type":"model","name":"ForceGraphComponentClass1"},{"type":"model","name":"newClass1"}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('p1029').textContent;
              const render_items = [{"docid":"ee3e5855-6423-4178-a53c-c42e1cd782f1","roots":{"p1002":"b8f1ca34-e6bd-4a39-81de-c0fc1e91f7a8","p1027":"e9225f5d-6ff1-4bc9-98de-07e119b7e044","p1028":"b1c96079-6af8-4dd5-b163-d6a1da9069bd"},"root_ids":["p1002","p1027","p1028"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
      else document.addEventListener("DOMContentLoaded", fn, {once: true});
      })();
    </script>
  </body>
</html>